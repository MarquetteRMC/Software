<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script src="https://static.robotwebtools.org/EventEmitter2/current/eventemitter2.min.js"></script>
<script src="https://static.robotwebtools.org/roslibjs/current/roslib.js"></script>

<script type="text/javascript">
	var ros = new ROSLIB.Ros({
		url : 'ws://10.0.2.15:9090'
	});

	// If there is an error on the backend, an 'error' emit will be emitted.
	ros.on('error', function(error) {
	document.getElementById('connecting').style.display = 'none';
	document.getElementById('connected').style.display = 'none';
	document.getElementById('closed').style.display = 'none';
	document.getElementById('error').style.display = 'inline';
	console.log(error);
	});
	// Find out exactly when we made a connection.
	ros.on('connection', function() {
	console.log('Connection made!');
	document.getElementById('connecting').style.display = 'none';
	document.getElementById('error').style.display = 'none';
	document.getElementById('closed').style.display = 'none';
	document.getElementById('connected').style.display = 'inline';
	});
	ros.on('close', function() {
	console.log('Connection closed.');
	document.getElementById('connecting').style.display = 'none';
	document.getElementById('connected').style.display = 'none';
	document.getElementById('closed').style.display = 'inline';
	});
	
	var listener = new ROSLIB.Topic({
		ros : ros,
		name : '/cmd_vel',
    	messageType : 'geometry_msgs/Twist'	
	});
	listener.subscribe(function(message) {
		document.getElementById('linearx').innerHTML = 'Robot X: ' + message.linear.x;
		document.getElementById('angularz').innerHTML = 'Robot Z: ' + message.angular.z;
	});

</script>

<body>
	<div id="statusIndicator">
	<p id="connecting">
	  Connecting to rosbridge...
	</p>
	<p id="connected" style="color:#00D600; display:none">
	  Connected
	</p>
	<p id="error" style="color:#FF0000; display:none">
	  Error in the backend!
	  make sure to run: roslaunch rosbridge_server rosbridge_websocket.launch
	</p>
	<p id="closed" style="display:none">
	  Connection closed.
	  make sure to run: roslaunch rosbridge_server rosbridge_websocket.launch
	</p>
	</div>
	
	<div id="subscriptions">
	<p id="linearx">Robot X: 0</p>
	<p id="angularz">Robot Z: 0</p>
	</div>
  


</body>
</html>
